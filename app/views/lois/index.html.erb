<div class="site-container">
<div id="form-paper">
  <div ng-app="app">
    <div ng-controller="loisIndexCtrl" ng-init="setup()">
      <div class="form-heading">
        <h1>LOI Submissions </h1>
      </div>
        <div class="panel panel-default">


<div style="z-index:1000;position:fixed;left:300px;" ng-if='loading'>
<style type='text/css'>@-webkit-keyframes uil-default-anim { 0% { opacity: 1} 100% {opacity: 0} }@keyframes uil-default-anim { 0% { opacity: 1} 100% {opacity: 0} }.uil-default-css > div:nth-of-type(1){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.5s;animation-delay: -0.5s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(2){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.4166666666666667s;animation-delay: -0.4166666666666667s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(3){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.33333333333333337s;animation-delay: -0.33333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(4){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.25s;animation-delay: -0.25s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(5){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.16666666666666669s;animation-delay: -0.16666666666666669s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(6){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.08333333333333331s;animation-delay: -0.08333333333333331s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(7){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0s;animation-delay: 0s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(8){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.08333333333333337s;animation-delay: 0.08333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(9){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.16666666666666663s;animation-delay: 0.16666666666666663s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(10){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.25s;animation-delay: 0.25s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(11){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.33333333333333337s;animation-delay: 0.33333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(12){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.41666666666666663s;animation-delay: 0.41666666666666663s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}</style><div class='uil-default-css' style='transform:scale(0.36);'><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(0deg) translate(0,-60px);transform:rotate(0deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(30deg) translate(0,-60px);transform:rotate(30deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(60deg) translate(0,-60px);transform:rotate(60deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(90deg) translate(0,-60px);transform:rotate(90deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(120deg) translate(0,-60px);transform:rotate(120deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(150deg) translate(0,-60px);transform:rotate(150deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(180deg) translate(0,-60px);transform:rotate(180deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(210deg) translate(0,-60px);transform:rotate(210deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(240deg) translate(0,-60px);transform:rotate(240deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(270deg) translate(0,-60px);transform:rotate(270deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(300deg) translate(0,-60px);transform:rotate(300deg) translate(0,-60px);border-radius:10px;position:absolute;'></div><div style='top:80px;left:93px;width:14px;height:40px;background:#00b2ff;-webkit-transform:rotate(330deg) translate(0,-60px);transform:rotate(330deg) translate(0,-60px);border-radius:10px;position:absolute;'></div></div>
</div>

          <table class="table table-hover" id="loi-table">
            <th style="width: 20%;">
              <p ng-click="sortBy('org_name')">
                Organization Name
                <span ng-class="toggle_class">
                </span>
              </p>
              <input ng-model="orgNameFilter" placeholder="filter" class="form-control">
            </th>
            <th style="width: 50%;">
              <p ng-click="sortBy(loi.answers[selectedAnswer.id])">
                Please select a question to see and compare
                <span ng-class="toggle_class">
                </span>
              </p>
              <select class="form-control" ng-model="selectedAnswer" ng-options="question.question group by question.section for question in questions">
                <option value="">-- choose question --</option>
              </select>

            </th>
            <th ng-show=<%="#{current_user.super_admin}"%>  style="width: 8%; text-align: center; vertical-align: middle">
            <p ng-click="sortBy('avgRatingPerLoi')">
                Average Rating
                <span ng-class="toggle_class">
                </span>
              </p>
            </th>
            <th style="width: 20%; text-align: center; vertical-align: middle">
              <p>Action</p>
            </th>
            <tr ng-repeat="loi in lois | filter: {org_name: orgNameFilter} | orderBy:sortByAttribute:descending">
              <td>
                <b>{{loi.org_name}}</b>
              </td>
              <td>
                <ul class="list-unstyled">
                  <li ng-repeat="answer in formatAnswer(loi.answers[selectedAnswer.id])">{{answer}}</li>
                </ul>
              </td>
              <td ng-show=<%="#{current_user.super_admin}"%> style="text-align:center;">
                <p>{{avgRatingPerLoi(loi.ratings)}}</p>
              </td>
              <td style="text-align:center;">
                <% if current_user && current_user.admin %>
                <div>
                  <a type="btn" href="/lois/{{loi.id}}" style="width:106.38px" class="btn btn-success btn-rate" ng-show="!rated(loi.ratings)">View/Rate</a>
                  <a type="btn" href="/lois/{{loi.id}}" style="width:106.38px" class="btn btn-warning btn-invite" ng-show="rated(loi.ratings)">View/Edit</a>
                </div>
                <% end %>
                  <% if current_user && current_user.super_admin %>
                  <div>
                    <button style="width:106.38px" class="btn btn-info btn-invite" ng-class="{'disabled': isDisabled}" ng-click="inviteSent(loi_status, loi.id); changeBtn(this)" ng-if="loi.invited_lois[0].status != true">{{btnText}}</button>

                    <button style="width:106.38px" class="btn btn-error btn-invite disabled" ng-if="loi.invited_lois[0].status == true">Invited</button>
                  </div>
                  <div>
                    <button style="width:106.38px" class="btn btn-danger btn-invite" ng-if="loi.reject == false || loi.reject == null" ng-click="changeReject(loi)">Delete LOI</button>
                  </div>

                  <% else %>
                    <!-- <button style="width:106.38px" class="btn btn-danger btn-rate disabled" ng-if="loi.invited_lois[0].status != true">{{btnText}}</button>
                    <button style="width:106.38px" class="btn btn-error btn-rate disabled" ng-if="loi.invited_lois[0].status == true">Invited</button> -->
                  <% end %>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>

  <div class="csv-btn">
    <% if current_user && current_user.admin %>
      <%= link_to "Download LOI CSV File", "/lois.csv", :class => "btn btn-primary", :role => "button" %>
    <% end %>
  </div>

  <hr>

  <div class="csv-btn span7 text-center">
    <% if current_user && current_user.super_admin %>
      <%= link_to "Send Rejection Emails", "/emails", :class => "btn btn-danger", :role => "button" %>
    <% end %>
  </div>

  </div>
</div>